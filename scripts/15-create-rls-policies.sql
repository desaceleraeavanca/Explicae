-- 1. Habilitar RLS para a tabela de tickets, se ainda não estiver habilitado\nALTER TABLE public.support_tickets ENABLE ROW LEVEL SECURITY;\n\n-- 2. Política para permitir que usuários criem (INSERT) seus próprios tickets\nCREATE POLICY "Allow users to create their own tickets" \nON public.support_tickets \nFOR INSERT \nWITH CHECK (auth.uid() = user_id);\n\n-- 3. Política para permitir que usuários leiam (SELECT) seus próprios tickets\nCREATE POLICY "Allow users to read their own tickets" \nON public.support_tickets \nFOR SELECT \nUSING (auth.uid() = user_id);\n\n-- 4. Política para permitir que administradores (role \'admin\') leiam (SELECT) todos os tickets\nCREATE POLICY "Allow admins to read all tickets" \nON public.support_tickets \nFOR SELECT \nUSING (get_my_claim(\'role\') = \'admin\');\n\n-- 5. Política para permitir que administradores (role \'admin\') atualizem (UPDATE) todos os tickets\nCREATE POLICY "Allow admins to update all tickets" \nON public.support_tickets \nFOR UPDATE \nUSING (get_my_claim(\'role\) = \'admin\')\nWITH CHECK (get_my_claim(\'role\) = \'admin\');\n